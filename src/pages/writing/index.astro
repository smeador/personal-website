---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import WritingHeader from "../../components/writing/WritingHeader.tsx";
import ArticleCard from "../../components/writing/ArticleCard.tsx";

// Get all articles and sort by date (newest first)
const allArticles = await getCollection("articles");
const sortedArticles = allArticles.sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime()
);
---

<BaseLayout
  title="Writing - Sean Meador"
  description="Explore my thoughts on technology, development, and the digital world through in-depth articles and insights."
>
  <section class="pt-8 md:pt-2 pb-20">
    <div class="container mx-auto max-w-5xl px-4">
      <!-- Writing header - matching home page style -->
      <WritingHeader client:load />

      <!-- Article list -->
      <div class="space-y-6">
        {
          sortedArticles.map((article, index) => (
            <ArticleCard article={article} index={index} client:load />
          ))
        }

        {
          sortedArticles.length === 0 && (
            <div class="text-center py-16">
              <div class="text-6xl mb-4">üìù</div>
              <h3 class="text-xl font-semibold text-foreground mb-2">
                No articles yet
              </h3>
              <p class="text-muted-foreground">
                Articles will appear here once they're published.
              </p>
            </div>
          )
        }
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
